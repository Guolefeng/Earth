define(["exports","./GeometryOffsetAttribute-1772960d","./Transforms-d5c6ad6e","./Matrix2-ccd5b911","./ComponentDatatype-93750d1a","./CylinderGeometryLibrary-dc0b434b","./when-4bbc8319","./RuntimeError-346a3079","./GeometryAttribute-c30799b8","./GeometryAttributes-7827a6c2","./IndexDatatype-b7d979a6","./VertexFormat-71718faa"],(function(t,e,a,r,n,o,i,s,m,u,d,p){"use strict";var y=new r.Cartesian2,l=new r.Cartesian3,f=new r.Cartesian3,b=new r.Cartesian3,c=new r.Cartesian3;function v(t){var e=(t=i.defaultValue(t,i.defaultValue.EMPTY_OBJECT)).length,a=t.topRadius,r=t.bottomRadius,n=i.defaultValue(t.vertexFormat,p.VertexFormat.DEFAULT),o=i.defaultValue(t.slices,128);this._length=e,this._topRadius=a,this._bottomRadius=r,this._vertexFormat=p.VertexFormat.clone(n),this._slices=o,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}v.packedLength=p.VertexFormat.packedLength+5,v.pack=function(t,e,a){return a=i.defaultValue(a,0),p.VertexFormat.pack(t._vertexFormat,e,a),a+=p.VertexFormat.packedLength,e[a++]=t._length,e[a++]=t._topRadius,e[a++]=t._bottomRadius,e[a++]=t._slices,e[a]=i.defaultValue(t._offsetAttribute,-1),e};var A,x=new p.VertexFormat,g={vertexFormat:x,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};v.unpack=function(t,e,a){e=i.defaultValue(e,0);var r=p.VertexFormat.unpack(t,e,x);e+=p.VertexFormat.packedLength;var n=t[e++],o=t[e++],s=t[e++],m=t[e++];e=t[e];return i.defined(a)?(a._vertexFormat=p.VertexFormat.clone(r,a._vertexFormat),a._length=n,a._topRadius=o,a._bottomRadius=s,a._slices=m,a._offsetAttribute=-1===e?void 0:e,a):(g.length=n,g.topRadius=o,g.bottomRadius=s,g.slices=m,g.offsetAttribute=-1===e?void 0:e,new v(g))},v.createGeometry=function(t){var s=t._length,p=t._topRadius,v=t._bottomRadius,A=t._vertexFormat,x=t._slices;if(!(s<=0||p<0||v<0||0===p&&0===v)){var g=x+x,_=x+g,h=g+g,F=o.CylinderGeometryLibrary.computePositions(s,p,v,x,!0),C=A.st?new Float32Array(2*h):void 0,w=A.normal?new Float32Array(3*h):void 0,G=A.tangent?new Float32Array(3*h):void 0,R=A.bitangent?new Float32Array(3*h):void 0,D=A.normal||A.tangent||A.bitangent;if(D){var V=A.tangent||A.bitangent,T=0,O=0,L=0,P=Math.atan2(v-p,s),E=l;E.z=Math.sin(P);for(var M=Math.cos(P),k=b,z=f,N=0;N<x;N++){var I=N/x*n.CesiumMath.TWO_PI,U=M*Math.cos(I);I=M*Math.sin(I);D&&(E.x=U,E.y=I,V&&(k=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,E,k),k)),A.normal&&(w[T++]=E.x,w[T++]=E.y,w[T++]=E.z,w[T++]=E.x,w[T++]=E.y,w[T++]=E.z),A.tangent&&(G[O++]=k.x,G[O++]=k.y,G[O++]=k.z,G[O++]=k.x,G[O++]=k.y,G[O++]=k.z),A.bitangent&&(z=r.Cartesian3.normalize(r.Cartesian3.cross(E,k,z),z),R[L++]=z.x,R[L++]=z.y,R[L++]=z.z,R[L++]=z.x,R[L++]=z.y,R[L++]=z.z))}for(N=0;N<x;N++)A.normal&&(w[T++]=0,w[T++]=0,w[T++]=-1),A.tangent&&(G[O++]=1,G[O++]=0,G[O++]=0),A.bitangent&&(R[L++]=0,R[L++]=-1,R[L++]=0);for(N=0;N<x;N++)A.normal&&(w[T++]=0,w[T++]=0,w[T++]=1),A.tangent&&(G[O++]=1,G[O++]=0,G[O++]=0),A.bitangent&&(R[L++]=0,R[L++]=1,R[L++]=0)}var S=d.IndexDatatype.createTypedArray(h,12*x-12),B=0,Y=0;for(N=0;N<x-1;N++)S[B++]=Y,S[B++]=Y+2,S[B++]=Y+3,S[B++]=Y,S[B++]=Y+3,S[B++]=Y+1,Y+=2;for(S[B++]=g-2,S[B++]=0,S[B++]=1,S[B++]=g-2,S[B++]=1,S[B++]=g-1,N=1;N<x-1;N++)S[B++]=g+N+1,S[B++]=g+N,S[B++]=g;for(N=1;N<x-1;N++)S[B++]=_,S[B++]=_+N,S[B++]=_+N+1;var Z=0;if(A.st){var J=Math.max(p,v);for(N=0;N<h;N++){var W=r.Cartesian3.fromArray(F,3*N,c);C[Z++]=(W.x+J)/(2*J),C[Z++]=(W.y+J)/(2*J)}}return P=new u.GeometryAttributes,A.position&&(P.position=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})),A.normal&&(P.normal=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:w})),A.tangent&&(P.tangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:G})),A.bitangent&&(P.bitangent=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),A.st&&(P.st=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:C})),y.x=.5*s,y.y=Math.max(v,p),v=new a.BoundingSphere(r.Cartesian3.ZERO,r.Cartesian2.magnitude(y)),i.defined(t._offsetAttribute)&&(s=F.length,p=new Uint8Array(s/3),s=t._offsetAttribute===e.GeometryOffsetAttribute.NONE?0:1,e.arrayFill(p,s),P.applyOffset=new m.GeometryAttribute({componentDatatype:n.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})),new m.Geometry({attributes:P,indices:S,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:v,offsetAttribute:t._offsetAttribute})}},v.getUnitCylinder=function(){return A=i.defined(A)?A:v.createGeometry(new v({topRadius:1,bottomRadius:1,length:1,vertexFormat:p.VertexFormat.POSITION_ONLY}))},t.CylinderGeometry=v}));