define(["exports","./Transforms-d5c6ad6e","./Matrix2-ccd5b911","./RuntimeError-346a3079","./when-4bbc8319","./EllipsoidTangentPlane-e000bae1","./ComponentDatatype-93750d1a","./Plane-18bb00f8"],(function(a,t,e,n,r,i,s,o){"use strict";function C(a,t){this.center=e.Cartesian3.clone(r.defaultValue(a,e.Cartesian3.ZERO)),this.halfAxes=e.Matrix3.clone(r.defaultValue(t,e.Matrix3.ZERO))}C.packedLength=e.Cartesian3.packedLength+e.Matrix3.packedLength,C.pack=function(a,t,n){return n=r.defaultValue(n,0),e.Cartesian3.pack(a.center,t,n),e.Matrix3.pack(a.halfAxes,t,n+e.Cartesian3.packedLength),t},C.unpack=function(a,t,n){return t=r.defaultValue(t,0),r.defined(n)||(n=new C),e.Cartesian3.unpack(a,t,n.center),e.Matrix3.unpack(a,t+e.Cartesian3.packedLength,n.halfAxes),n};var c=new e.Cartesian3,u=new e.Cartesian3,d=new e.Cartesian3,l=new e.Cartesian3,h=new e.Cartesian3,x=new e.Cartesian3,m=new e.Matrix3,M={unitary:new e.Matrix3,diagonal:new e.Matrix3};C.fromPoints=function(a,t){if(r.defined(t)||(t=new C),!r.defined(a)||0===a.length)return t.halfAxes=e.Matrix3.ZERO,t.center=e.Cartesian3.ZERO,t;for(var n=a.length,i=e.Cartesian3.clone(a[0],c),s=1;s<n;s++)e.Cartesian3.add(i,a[s],i);var o=1/n;e.Cartesian3.multiplyByScalar(i,o,i);var f,p=0,g=0,w=0,y=0,b=0,N=0;for(s=0;s<n;s++)p+=(f=e.Cartesian3.subtract(a[s],i,u)).x*f.x,g+=f.x*f.y,w+=f.x*f.z,y+=f.y*f.y,b+=f.y*f.z,N+=f.z*f.z;g*=o,w*=o,y*=o,b*=o,N*=o,(O=m)[0]=p*=o,O[1]=g,O[2]=w,O[3]=g,O[4]=y,O[5]=b,O[6]=w,O[7]=b,O[8]=N;var O=e.Matrix3.computeEigenDecomposition(O,M),P=(O=e.Matrix3.clone(O.unitary,t.halfAxes),e.Matrix3.getColumn(O,0,l)),T=e.Matrix3.getColumn(O,1,h),A=e.Matrix3.getColumn(O,2,x),I=-Number.MAX_VALUE,R=-Number.MAX_VALUE,E=-Number.MAX_VALUE,S=Number.MAX_VALUE,U=Number.MAX_VALUE,L=Number.MAX_VALUE;for(s=0;s<n;s++)f=a[s],I=Math.max(e.Cartesian3.dot(P,f),I),R=Math.max(e.Cartesian3.dot(T,f),R),E=Math.max(e.Cartesian3.dot(A,f),E),S=Math.min(e.Cartesian3.dot(P,f),S),U=Math.min(e.Cartesian3.dot(T,f),U),L=Math.min(e.Cartesian3.dot(A,f),L);return P=e.Cartesian3.multiplyByScalar(P,.5*(S+I),P),T=e.Cartesian3.multiplyByScalar(T,.5*(U+R),T),A=e.Cartesian3.multiplyByScalar(A,.5*(L+E),A),O=e.Cartesian3.add(P,T,t.center),e.Cartesian3.add(O,A,O),(O=d).x=I-S,O.y=R-U,O.z=E-L,e.Cartesian3.multiplyByScalar(O,.5,O),e.Matrix3.multiplyByScale(t.halfAxes,O,t.halfAxes),t};var f=new e.Cartesian3,p=new e.Cartesian3;function g(a,t,n,i,s,o,c,u,d,l,h){var x=(h=r.defined(h)?h:new C).halfAxes;return e.Matrix3.setColumn(x,0,t,x),e.Matrix3.setColumn(x,1,n,x),e.Matrix3.setColumn(x,2,i,x),(n=f).x=(s+o)/2,n.y=(c+u)/2,n.z=(d+l)/2,(i=p).x=(o-s)/2,i.y=(u-c)/2,i.z=(l-d)/2,d=h.center,n=e.Matrix3.multiplyByVector(x,n,n),e.Cartesian3.add(a,n,d),e.Matrix3.multiplyByScale(x,i,x),h}var w=new e.Cartographic,y=new e.Cartesian3,b=new e.Cartographic,N=new e.Cartographic,O=new e.Cartographic,P=new e.Cartographic,T=new e.Cartographic,A=new e.Cartesian3,I=new e.Cartesian3,R=new e.Cartesian3,E=new e.Cartesian3,S=new e.Cartesian3,U=new e.Cartesian2,L=new e.Cartesian2,v=new e.Cartesian2,z=new e.Cartesian2,B=new e.Cartesian2,V=new e.Cartesian3,_=new e.Cartesian3,k=new e.Cartesian3,W=new e.Cartesian3,D=new e.Cartesian2,X=new e.Cartesian3,q=new e.Cartesian3,j=new e.Cartesian3,Z=new o.Plane(e.Cartesian3.UNIT_X,0);C.fromRectangle=function(a,t,n,C,c){if(t=r.defaultValue(t,0),n=r.defaultValue(n,0),C=r.defaultValue(C,e.Ellipsoid.WGS84),a.width<=s.CesiumMath.PI){var u=e.Rectangle.center(a,w),d=C.cartographicToCartesian(u,y),l=new i.EllipsoidTangentPlane(d,C),h=l.plane,x=u.longitude,m=a.south<0&&0<a.north?0:u.latitude,M=e.Cartographic.fromRadians(x,a.north,n,b),f=e.Cartographic.fromRadians(a.west,a.north,n,N),p=e.Cartographic.fromRadians(a.west,m,n,O),Y=e.Cartographic.fromRadians(a.west,a.south,n,P),G=e.Cartographic.fromRadians(x,a.south,n,T),F=C.cartographicToCartesian(M,A),H=C.cartographicToCartesian(f,I),J=C.cartographicToCartesian(p,R),K=C.cartographicToCartesian(Y,E);d=C.cartographicToCartesian(G,S),u=l.projectPointToNearestOnPlane(F,U),m=l.projectPointToNearestOnPlane(H,L),x=l.projectPointToNearestOnPlane(J,v),M=l.projectPointToNearestOnPlane(K,z),p=l.projectPointToNearestOnPlane(d,B),F=-(G=Math.min(m.x,x.x,M.x)),J=Math.max(m.y,u.y),d=Math.min(M.y,p.y);return f.height=Y.height=t,H=C.cartographicToCartesian(f,I),K=C.cartographicToCartesian(Y,E),x=Math.min(o.Plane.getPointDistance(h,H),o.Plane.getPointDistance(h,K)),m=n,g(l.origin,l.xAxis,l.yAxis,l.zAxis,G,F,d,J,x,m,c)}return u=0<a.south,M=a.north<0,p=u?a.south:M?a.north:0,f=e.Rectangle.center(a,w).longitude,(Y=e.Cartesian3.fromRadians(f,p,n,C,V)).z=0,H=Math.abs(Y.x)<s.CesiumMath.EPSILON10&&Math.abs(Y.y)<s.CesiumMath.EPSILON10?e.Cartesian3.UNIT_X:e.Cartesian3.normalize(Y,_),K=e.Cartesian3.UNIT_Z,l=e.Cartesian3.cross(H,K,k),h=o.Plane.fromPointNormal(Y,H,Z),f=e.Cartesian3.fromRadians(f+s.CesiumMath.PI_OVER_TWO,p,n,C,W),G=-(F=e.Cartesian3.dot(o.Plane.projectPointOntoPlane(h,f,D),l)),J=e.Cartesian3.fromRadians(0,a.north,M?t:n,C,X).z,d=e.Cartesian3.fromRadians(0,a.south,u?t:n,C,q).z,C=e.Cartesian3.fromRadians(a.east,p,n,C,j),g(Y,l,K,H,G,F,d,J,x=o.Plane.getPointDistance(h,C),m=0,c)},C.clone=function(a,t){if(r.defined(a))return r.defined(t)?(e.Cartesian3.clone(a.center,t.center),e.Matrix3.clone(a.halfAxes,t.halfAxes),t):new C(a.center,a.halfAxes)},C.intersectPlane=function(a,n){var r=a.center,i=n.normal,s=a.halfAxes,o=i.x,C=i.y;a=i.z,s=Math.abs(o*s[e.Matrix3.COLUMN0ROW0]+C*s[e.Matrix3.COLUMN0ROW1]+a*s[e.Matrix3.COLUMN0ROW2])+Math.abs(o*s[e.Matrix3.COLUMN1ROW0]+C*s[e.Matrix3.COLUMN1ROW1]+a*s[e.Matrix3.COLUMN1ROW2])+Math.abs(o*s[e.Matrix3.COLUMN2ROW0]+C*s[e.Matrix3.COLUMN2ROW1]+a*s[e.Matrix3.COLUMN2ROW2]);return(n=e.Cartesian3.dot(i,r)+n.distance)<=-s?t.Intersect.OUTSIDE:s<=n?t.Intersect.INSIDE:t.Intersect.INTERSECTING};var Y=new e.Cartesian3,G=new e.Cartesian3,F=new e.Cartesian3,H=new e.Cartesian3,J=new e.Cartesian3,K=new e.Cartesian3;C.distanceSquaredTo=function(a,t){var n,r,i,o=e.Cartesian3.subtract(t,a.center,f),C=a.halfAxes,c=e.Matrix3.getColumn(C,0,Y),u=e.Matrix3.getColumn(C,1,G),d=e.Matrix3.getColumn(C,2,F),l=e.Cartesian3.magnitude(c),h=e.Cartesian3.magnitude(u),x=e.Cartesian3.magnitude(d),m=!0;t=!0,a=!0;0<l?e.Cartesian3.divideByScalar(c,l,c):m=!1,0<h?e.Cartesian3.divideByScalar(u,h,u):t=!1,0<x?e.Cartesian3.divideByScalar(d,x,d):a=!1,1==(C=!m+!t+!a)?(m=c,r=u,i=d,t?a||(m=d,i=c):(m=u,r=c),n=e.Cartesian3.cross(r,i,J),m===c?c=n:m===u?u=n:m===d&&(d=n)):2==C?(r=c,t?r=u:a&&(r=d),(a=e.Cartesian3.UNIT_Y).equalsEpsilon(r,s.CesiumMath.EPSILON3)&&(a=e.Cartesian3.UNIT_X),i=e.Cartesian3.cross(r,a,H),e.Cartesian3.normalize(i,i),n=e.Cartesian3.cross(r,i,J),e.Cartesian3.normalize(n,n),r===c?(u=i,d=n):r===u?(d=i,c=n):r===d&&(c=i,u=n)):3==C&&(c=e.Cartesian3.UNIT_X,u=e.Cartesian3.UNIT_Y,d=e.Cartesian3.UNIT_Z),(C=K).x=e.Cartesian3.dot(o,c),C.y=e.Cartesian3.dot(o,u),C.z=e.Cartesian3.dot(o,d);var M;d=0;return C.x<-l?d+=(M=C.x+l)*M:C.x>l&&(d+=(M=C.x-l)*M),C.y<-h?d+=(M=C.y+h)*M:C.y>h&&(d+=(M=C.y-h)*M),C.z<-x?d+=(M=C.z+x)*M:C.z>x&&(d+=(M=C.z-x)*M),d};var Q=new e.Cartesian3,$=new e.Cartesian3;C.computePlaneDistances=function(a,n,i,s){r.defined(s)||(s=new t.Interval);var o=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,c=a.center,u=a.halfAxes,d=e.Matrix3.getColumn(u,0,Y),l=e.Matrix3.getColumn(u,1,G),h=e.Matrix3.getColumn(u,2,F),x=e.Cartesian3.add(d,l,Q);return e.Cartesian3.add(x,h,x),e.Cartesian3.add(x,c,x),a=e.Cartesian3.subtract(x,n,$),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.add(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.add(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.add(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),e.Cartesian3.subtract(c,d,x),e.Cartesian3.subtract(x,l,x),e.Cartesian3.subtract(x,h,x),e.Cartesian3.subtract(x,n,a),u=e.Cartesian3.dot(i,a),o=Math.min(u,o),C=Math.max(u,C),s.start=o,s.stop=C,s};var aa=new t.BoundingSphere;C.isOccluded=function(a,e){return a=t.BoundingSphere.fromOrientedBoundingBox(a,aa),!e.isBoundingSphereVisible(a)},C.prototype.intersectPlane=function(a){return C.intersectPlane(this,a)},C.prototype.distanceSquaredTo=function(a){return C.distanceSquaredTo(this,a)},C.prototype.computePlaneDistances=function(a,t,e){return C.computePlaneDistances(this,a,t,e)},C.prototype.isOccluded=function(a){return C.isOccluded(this,a)},C.equals=function(a,t){return a===t||r.defined(a)&&r.defined(t)&&e.Cartesian3.equals(a.center,t.center)&&e.Matrix3.equals(a.halfAxes,t.halfAxes)},C.prototype.clone=function(a){return C.clone(this,a)},C.prototype.equals=function(a){return C.equals(this,a)},a.OrientedBoundingBox=C}));