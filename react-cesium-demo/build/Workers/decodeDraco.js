define(["./ComponentDatatype-93750d1a","./when-4bbc8319","./IndexDatatype-b7d979a6","./RuntimeError-346a3079","./createTaskProcessorWorker","./WebGLConstants-1c8239cc"],(function(e,t,r,n,o,a){"use strict";var i;function u(r,n,o){var a,u=r.num_points(),s=o.num_components(),c=new i.AttributeQuantizationTransform;if(c.InitFromAttribute(o)){for(var d=new Array(s),y=0;y<s;++y)d[y]=c.min_value(y);a={quantizationBits:c.quantization_bits(),minValues:d,range:c.range(),octEncoded:!1}}return i.destroy(c),(c=new i.AttributeOctahedronTransform).InitFromAttribute(o)&&(a={quantizationBits:c.quantization_bits(),octEncoded:!0}),i.destroy(c),u*=s,n=t.defined(a)?function(e,t,r,n,o){var a,u;n.quantizationBits<=8?(u=new i.DracoUInt8Array,a=new Uint8Array(o),t.GetAttributeUInt8ForAllPoints(e,r,u)):(u=new i.DracoUInt16Array,a=new Uint16Array(o),t.GetAttributeUInt16ForAllPoints(e,r,u));for(var s=0;s<o;++s)a[s]=u.GetValue(s);return i.destroy(u),a}(r,n,o,a,u):function(e,t,r,n){var o,a;switch(r.data_type()){case 1:case 11:a=new i.DracoInt8Array,o=new Int8Array(n),t.GetAttributeInt8ForAllPoints(e,r,a);break;case 2:a=new i.DracoUInt8Array,o=new Uint8Array(n),t.GetAttributeUInt8ForAllPoints(e,r,a);break;case 3:a=new i.DracoInt16Array,o=new Int16Array(n),t.GetAttributeInt16ForAllPoints(e,r,a);break;case 4:a=new i.DracoUInt16Array,o=new Uint16Array(n),t.GetAttributeUInt16ForAllPoints(e,r,a);break;case 5:case 7:a=new i.DracoInt32Array,o=new Int32Array(n),t.GetAttributeInt32ForAllPoints(e,r,a);break;case 6:case 8:a=new i.DracoUInt32Array,o=new Uint32Array(n),t.GetAttributeUInt32ForAllPoints(e,r,a);break;case 9:case 10:a=new i.DracoFloat32Array,o=new Float32Array(n),t.GetAttributeFloatForAllPoints(e,r,a)}for(var u=0;u<n;++u)o[u]=a.GetValue(u);return i.destroy(a),o}(r,n,o,u),{array:n,data:{componentsPerAttribute:s,componentDatatype:u=e.ComponentDatatype.fromTypedArray(n),byteOffset:o.byte_offset(),byteStride:e.ComponentDatatype.getSizeInBytes(u)*s,normalized:o.normalized(),quantization:a}}}function s(e){var t=new i.Decoder,o=e.bufferView,a=new i.DecoderBuffer;if(a.Init(e.array,o.byteLength),t.GetEncodedGeometryType(a)!==i.TRIANGULAR_MESH)throw new n.RuntimeError("Unsupported draco mesh geometry type.");var s=new i.Mesh;if(!(o=t.DecodeBufferToMesh(a,s)).ok()||0===s.ptr)throw new n.RuntimeError("Error decoding draco mesh geometry: "+o.error_msg());i.destroy(a);var c,d,y={},f=e.compressedAttributes;for(c in f)f.hasOwnProperty(c)&&(d=f[c],d=t.GetAttributeByUniqueId(s,d),y[c]=u(s,t,d));return e={indexArray:function(e,t){for(var n=e.num_points(),o=e.num_faces(),a=new i.DracoInt32Array,u=3*o,s=r.IndexDatatype.createTypedArray(n,u),c=0,d=0;d<o;++d)t.GetFaceFromMesh(e,d,a),s[c+0]=a.GetValue(0),s[c+1]=a.GetValue(1),s[c+2]=a.GetValue(2),c+=3;return i.destroy(a),{typedArray:s,numberOfIndices:u}}(s,t),attributeData:y},i.destroy(s),i.destroy(t),e}function c(e){return(t.defined(e.bufferView)?s:function(e){var t=new i.Decoder;e.dequantizeInShader&&(t.SkipAttributeTransform(i.POSITION),t.SkipAttributeTransform(i.NORMAL));var r=new i.DecoderBuffer;if(r.Init(e.buffer,e.buffer.length),t.GetEncodedGeometryType(r)!==i.POINT_CLOUD)throw new n.RuntimeError("Draco geometry type must be POINT_CLOUD.");var o=new i.PointCloud,a=t.DecodeBufferToPointCloud(r,o);if(!a.ok()||0===o.ptr)throw new n.RuntimeError("Error decoding draco point cloud: "+a.error_msg());i.destroy(r);var s,c,d={},y=e.properties;for(s in y)y.hasOwnProperty(s)&&(c=y[s],c=t.GetAttributeByUniqueId(o,c),d[s]=u(o,t,c));return i.destroy(o),i.destroy(t),d})(e)}function d(e){i=e,self.onmessage=o(c),self.postMessage(!0)}return function(e){var r=e.data.webAssemblyConfig;if(t.defined(r))return require([r.modulePath],(function(e){t.defined(r.wasmBinaryFile)?(e=t.defined(e)?e:self.DracoDecoderModule)(r).then((function(e){d(e)})):d(e())}))}}));